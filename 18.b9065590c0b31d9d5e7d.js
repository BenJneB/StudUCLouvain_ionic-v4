(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{"8Z/B":function(t,e){t.exports='\x3c!--\n    Copyright (c)  Universit\xe9 catholique Louvain.  All rights reserved\n    Authors : Benjamin Daubry & Bruno Marchesini and J\xe9r\xf4me Lemaire & Corentin Lamy\n    Date : 2018-2019\n    This file is part of Stud.UCLouvain\n    Licensed under the GPL 3.0 license. See LICENSE file in the project root for full license information.\n\n    Stud.UCLouvain is free software: you can redistribute it and/or modify\n    it under the terms of the GNU General Public License as published by\n    the Free Software Foundation, either version 3 of the License, or\n    (at your option) any later version.\n\n    Stud.UCLouvain is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU General Public License for more details.\n\n    You should have received a copy of the GNU General Public License\n    along with Stud.UCLouvain.  If not, see <http://www.gnu.org/licenses/>.\n--\x3e\n\x3c!--EN-TETE--\x3e\n<ion-header>\n    <ion-toolbar color="sport">\n        <ion-buttons slot="start">\n            <ion-back-button></ion-back-button>\n            <img height="28" src="./assets/img/s.png"/>\n        </ion-buttons>\n        <ion-title>\n            <img alt="logo" height="40" src="./assets/img/logoSport.png">\n        </ion-title>\n        <ion-buttons slot="end">\n            <ion-button (click)="presentFilter()">\n                <ion-icon name="options"></ion-icon>\n            </ion-button>\n        </ion-buttons>\n    </ion-toolbar>\n    <ion-segment [(ngModel)]="segment" name="segment" (ionChange)="tabChanged($event)">\n        <ion-segment-button value="all">\n            <ion-label>{{\'SPORTS.ALL\' | translate}}</ion-label>\n        </ion-segment-button>\n        <ion-segment-button value="team">\n            <ion-label>{{\'SPORTS.TEAM\' | translate}}</ion-label>\n        </ion-segment-button>\n        <ion-segment-button value="favorites">\n            <ion-label>{{\'SPORTS.FAV\' | translate}}</ion-label>\n        </ion-segment-button>\n    </ion-segment>\n</ion-header>\n\n\x3c!--BODY--\x3e\n\x3c!--class="feed-list" --\x3e\n<ion-content class="all" [ngClass]="{\'team\' : segment == \'team\'}">\n    <ion-refresher slot="fixed" *ngIf="segment !== \'favorites\'" (ionRefresh)="doRefresh($event)">\n        <ion-refresher-content pullingIcon="arrow-dropdown" pullingText="Pull to refresh" refreshingSpinner="circles">\n        </ion-refresher-content>\n    </ion-refresher>\n    <ion-searchbar [(ngModel)]="searchTerm" [formControl]="searchControl"></ion-searchbar>\n\n    <ion-list #sportsList *ngFor="let jour of displayedSportsD" [hidden]="shownSports === 0">\n        <ion-item-divider (click)="toggleGroup(jour.label)" *ngIf="jour.items.length > 0">\n            <ion-label class="ion-text-center"\n                       style="width: 100%;"> {{jour.label}} {{jour.items[0].date | date: \'dd/MM\'}}\n                ({{jour.items.length}})\n            </ion-label>\n        </ion-item-divider>\n\n        <ion-item-sliding #slidingItem *ngFor="let sport of jour.items"\n                          [hidden]="!utilsServices.isGroupShown(jour.label, shownGroup) || sport.hidden">\n            <ion-item class="ion-text-center">\n                <ion-label>\n                    <h3>{{sport.sport}} {{sport.sexe}} {{sport.type}}</h3>\n                    <p>{{sport.lieu}} - Salle : {{sport.salle}}</p>\n                    <p>\n                        <ion-icon name="calendar" slot="start"></ion-icon>\n                        {{sport.jour}} {{sport.date | date: \'dd/MM/yyyy H:mm\' }} &mdash;\n                        {{sport.hfin | date : \'H:mm\'}}\n                    </p>\n                    <p *ngIf="sport.online==1" style="color:red !important;">{{\'SPORTS.ONLINE\' | translate}}</p>\n                    <p *ngIf="sport.remarque.length > 2" style="color:red !important;">{{\'SPORTS.NOTE\' | translate}} :\n                        {{sport.remarque}}</p>\n                    <p *ngIf="sport.active==0" style="color:red !important;">{{\'SPORTS.ANNULE\' | translate}}</p>\n                </ion-label>\n            </ion-item>\n\n            <ion-item-options side="end">\n                <ion-item-option (click)="addToCalendar(slidingItem, sport)" class="large-icon">\n                    <ion-icon name=\'calendar\' size="large"></ion-icon>\n                </ion-item-option>\n                <ion-item-option (click)="addFavorite(slidingItem, sport)"\n                                 *ngIf="segment === \'all\' || segment === \'team\'">\n                    <ion-icon name="star-outline" size="large"></ion-icon>\n                </ion-item-option>\n                <ion-item-option (click)="removeFavorite(slidingItem, sport, \'Remove Favorite\')"\n                                 *ngIf="segment === \'favorites\'">\n                    <ion-icon name=\'close\' size="large"></ion-icon>\n                </ion-item-option>\n            </ion-item-options>\n\n        </ion-item-sliding>\n\n    </ion-list>\n\n    <ion-list-header *ngIf="((nosport && segment === \'all\') || (noteams && segment === \'team\')) && !searching"\n                     [ngClass]="{\'team\' : segment == \'team\'}"\n                     class="all">\n        <ion-label>{{\'SPORTS.NOTHING\' | translate}}</ion-label>\n    </ion-list-header>\n</ion-content>\n\n<ion-footer style="opacity: 0.5" class="ion-text-center" *ngIf="segment==\'all\' || segment==\'team\'">\n    <ion-toolbar color="sport">\n        <ion-icon name=\'help-circle\'></ion-icon>\n        <ion-label>{{\'SPORTS.SWIPE\' | translate}}</ion-label>\n    </ion-toolbar>\n</ion-footer>'},"MS+s":function(t,e,n){"use strict";n.r(e);var i=n("mrSG"),o=n("Ip0R"),s=n("CcnG"),r=n("gIcY"),a=n("ZZ/e"),l=n("A7o+"),h=n("cMM6"),c=function(){return function(t,e,n,i,o,s,r,a,l,h,c,u,p,d){this.sport=t,this.sexe=e,this.lieu=n,this.salle=i,this.jour=o,this.date=s,this.hidden=r,this.favorite=a,this.hfin=l,this.type=h,this.online=c,this.remarque=u,this.active=p,this.guid=d}}(),u=n("oHzx"),p=n("dWyT"),d=function(){function t(t,e){this.user=t,this.rssService=e,this.sports=[],this.teams=[],this.allCategories=[],this.allCategoriesT=[],this.shownSports=0,this.shownTeams=0,this.url="",this.urlT=""}return t.prototype.update=function(){this.url="https://uclsport.uclouvain.be/smartrss.php?-public=etu&-startdate=",this.urlT="https://uclsport.uclouvain.be/smartrss.php?-public=equip&-startdate=";var t=this.getSportsDates(function(t){return t.toISOString().split("T")[0]}),e=t.todayString,n=t.endString,i=this.getSportCampus(),o=e+"&-enddate="+n+"&-site=",s=this.url+o+i,r=this.urlT+o+"louv";this.url=s,this.urlT=r},t.prototype.getSports=function(t){var e=this,n=this.getSportsDatas(t);return this.rssService.load(n.url,!0).then(function(i){return e.extractSports(i,"team"!==t),{sports:n.sports,shownSports:n.shownSports,categories:n.categories}}).catch(function(n){return 1===n?e.getSports(t):(2===n?console.log("Loading sports: GET req timed out > limit, suppose no sports to be displayed"):console.log("Error loading sports: "+n),{sports:[],shownSports:0,categories:[]})})},t.prototype.getSportsDates=function(t){var e=new Date,n=new Date;return n.setDate(e.getDate()+6),{todayString:t(e),endString:t(n)}},t.prototype.getSportCampus=function(){var t,e=this.user.campus;return"LLN"===e&&(t="louv"),"Woluwe"===e&&(t="wol"),"Mons"===e&&(t="mons"),t},t.prototype.getSportsDatas=function(t){this.update();var e="all"===t;return e?this.sports=[]:this.teams=[],{sports:e?this.sports:this.teams,shownSports:e?this.shownSports:this.shownTeams,url:e?this.url:this.urlT,categories:e?this.allCategories:this.allCategoriesT}},t.prototype.extractSports=function(t,e){if(void 0===e&&(e=!0),void 0!==t){if(void 0===t.length){var n=t;(t=[]).push(n)}this.shownSports=0,this.shownTeams=0;for(var i=0;i<t.length;i++){var o=t[i],s=!1;this.user.hasFavorite(o.guid)&&(s=!0),this.updateEventsData(o,e),this.pushSportItem(o,!1,s,e)}}else console.log("Error sports data undefined!!!")},t.prototype.pushSportItem=function(t,e,n,i){var o=this.createDateForSport(t.date,t.hdebut),s=this.createDateForSport(t.date,t.hfin),r=new c(t.activite,t.genre,t.lieu,t.salle,t.jour,o,e,n,s,t.type,t.online,t.remarque,t.active,t.activite.concat(t.date.toString()+t.hdebut.toString()));i?this.sports.push(r):this.teams.push(r)},t.prototype.updateEventsData=function(t,e){t.activite&&this.getGoodCategories(e,t),e?this.shownSports++:this.shownTeams++},t.prototype.getGoodCategories=function(t,e){t?this.getCategories(this.allCategories,e):this.getCategories(this.allCategoriesT,e)},t.prototype.getCategories=function(t,e){t.indexOf(e.activite)<0&&t.push(e.activite),t.sort()},t.prototype.createDateForSport=function(t,e){var n=e.split(":"),i=t.split("/"),o=parseInt(i[2],10),s=parseInt(i[1],10)-1,r=parseInt(i[0],10),a=parseInt(n[0],10),l=parseInt(n[1],10);return new Date(o,s,r,a,l)},t=i.c([Object(s.B)(),i.f("design:paramtypes",[u.a,p.a])],t)}(),g=n("lmKE"),f=n("sp4+"),m=n("XlaX"),S=n("sOJy"),v=function(){function t(t,e){this.navParams=t,this.alertService=e,this.categories=[];var n=this.navParams.get("excludedFilters"),i=this.navParams.get("filters");this.dateRange=this.navParams.get("dateRange");for(var o=0,s=i;o<s.length;o++){var r=s[o];this.categories.push({name:r,isChecked:-1===n.indexOf(r)})}}return t.prototype.resetFilters=function(){this.categories.forEach(function(t){t.isChecked=!0})},t.prototype.uncheckAll=function(){this.categories.forEach(function(t){t.isChecked=!1})},t=i.c([Object(s.n)({selector:"page-sports-filter",template:n("MmdH"),styles:[n("QZse")]}),i.f("design:paramtypes",[a.k,g.a])],t)}(),b=function(){function t(t,e,n,i,o,s,a,l,h){this.alertService=t,this.modalCtrl=e,this.sportsService=n,this.user=i,this.calendar=o,this.connService=s,this.loader=a,this.navCtrl=l,this.utilsServices=h,this.sports=[],this.teams=[],this.searching=!1,this.segment="all",this.shownSports=0,this.shownTeams=0,this.searchTerm="",this.filters=[],this.filtersT=[],this.excludedFilters=[],this.excludedFiltersT=[],this.displayedSports=[],this.displayedSportsD=[],this.dateRange=7,this.dateLimit=new Date,this.shownGroup=null,this.nosport=!1,this.noteams=!1,this.texts={FAV:"SPORTS.MESSAGEFAV",FAV2:"SPORTS.FAVADD",FAV3:"SPORTS.MESSAGEFAV2",CANCEL:"SPORTS.CANCEL",DEL:"DELETE"},this.searchControl=new r.a,this.updateDateLimit()}return t.prototype.ngOnInit=function(){return i.b(this,void 0,void 0,function(){return i.e(this,function(t){switch(t.label){case 0:return this.connService.isOnline()?[4,this.loader.present("Please wait..")]:[3,2];case 1:return t.sent(),this.loadSports(this.segment),this.loadSports("team"),this.utilsServices.initSearchControl(this.searchControl,this.searching),this.updateDisplayed(),[3,3];case 2:this.utilsServices.initSearchControl(this.searchControl,this.searching),this.navCtrl.pop(),this.connService.presentConnectionAlert(),t.label=3;case 3:return[2]}})})},t.prototype.doRefresh=function(t){this.loadSports(this.segment),t.target.complete()},t.prototype.onSearchInput=function(){this.searching=!0},t.prototype.toggleGroup=function(t){this.shownGroup=this.utilsServices.toggleGroup(t,this.shownGroup)},t.prototype.loadSports=function(t){var e=this;this.searching=!0,this.campus=this.user.campus,this.connService.isOnline()?this.sportsService.getSports(t).then(function(n){e.assignDatas("team"===t,n)}):(this.searching=!1,this.navCtrl.pop(),this.connService.presentConnectionAlert())},t.prototype.changeArray=function(t){var e=t.reduce(function(t,e){return t[e.jour]=t[e.jour]||[],t[e.jour].push(e),t},{});return this.utilsServices.getItemDisplay(e)},t.prototype.updateDisplayed=function(){if(this.searching=!0,!0===this.isNotFavorite()){var t="all"===this.segment?this.sports:this.teams;this.displayedSports=this.filterDisplayedSports(t,this.excludedFilters)}else"favorites"===this.segment&&(this.displayedSports=this.utilsServices.filterFavoriteItems(this.sports,this.searchTerm,"sports"));this.shownSports=this.displayedSports.length,this.searching=!1,this.displayedSportsD=this.changeArray(this.displayedSports),this.loader.dismiss()},t.prototype.tabChanged=function(t){void 0!==t&&this.updateDisplayed()},t.prototype.presentFilter=function(){return i.b(this,void 0,void 0,function(){var t,e,n,o,s=this;return i.e(this,function(i){switch(i.label){case 0:return t=this.getFiltersData("team"===this.segment),e=void 0===t.filters?[]:t.filters,n=t.exclude,[4,this.modalCtrl.create({component:v,componentProps:{excludedFilters:n,filters:e,dateRange:this.dateRange}})];case 1:return(o=i.sent()).onDidDismiss().then(function(t){if(t){var e=(t=t.data)[1];e!==s.dateRange&&(s.dateRange=e,s.updateDateLimit());var n=t[0];"all"===s.segment?s.excludedFilters=n:"team"===s.segment&&(s.excludedFiltersT=n),s.updateDisplayed()}}),[4,o.present()];case 2:return[2,i.sent()]}})})},t.prototype.addToCalendar=function(t,e){var n=this;this.calendar.createEventWithOptions(e.sport,e.lieu,e.salle,e.date,e.hfin,{firstReminderMinutes:30}).then(function(){n.alertService.presentToast("Sport cr\xe9\xe9",t)})},t.prototype.addFavorite=function(t,e){return i.b(this,void 0,void 0,function(){return i.e(this,function(n){switch(n.label){case 0:return[4,this.utilsServices.addFavorite(e,this.texts,t)];case 1:return n.sent(),[2]}})})},t.prototype.removeFavorite=function(t,e,n){return i.b(this,void 0,void 0,function(){return i.e(this,function(i){switch(i.label){case 0:return[4,this.utilsServices.removeFavorite(t,e,n,this.texts)];case 1:return i.sent(),this.updateDisplayed(),[2]}})})},t.prototype.assignDatas=function(t,e){t?this.teams=e.sports:this.sports=e.sports,t?this.shownTeams=e.shownSports:this.shownSports=e.shownSports,t?this.filtersT=e.categories:this.filters=e.categories,t?this.noteams=0===e.sports.length:this.nosport=0===e.sports.length,this.searching=!1},t.prototype.isNotFavorite=function(){return"all"===this.segment||"team"===this.segment},t.prototype.filterDisplayedSports=function(t,e){return this.utilsServices.filterItems("sports",t,e,this.dateLimit,this.searchTerm)},t.prototype.getFiltersData=function(t){return!0===t?{filters:this.filtersT,exclude:this.excludedFiltersT}:{filters:this.filters,exclude:this.excludedFilters}},t.prototype.updateDateLimit=function(){var t=new Date;this.dateLimit=new Date(t.getFullYear(),t.getMonth(),t.getUTCDate()+this.dateRange)},i.c([Object(s.lb)("sportsList",{read:a.d}),i.f("design:type",a.d)],t.prototype,"sportsList",void 0),t=i.c([Object(s.n)({selector:"page-sports",template:n("8Z/B"),styles:[n("y51y")]}),i.f("design:paramtypes",[g.a,a.i,d,u.a,h.a,f.a,m.a,a.j,S.b])],t)}(),y=function(){function t(){}return t=i.c([Object(s.J)({declarations:[v],imports:[a.f,r.d,o.b,r.b,l.b.forChild()],entryComponents:[v],providers:[d]})],t)}(),T=n("ZYCi"),w=[{path:"",component:b}],L=function(){function t(){}return t=i.c([Object(s.J)({imports:[T.h.forChild(w)],exports:[T.h]})],t)}();n.d(e,"SportsPageModule",function(){return C});var C=function(){function t(){}return t=i.c([Object(s.J)({declarations:[b],imports:[a.f,r.d,o.b,r.b,y,l.b.forChild(),L],providers:[d,h.a,f.a]})],t)}()},MmdH:function(t,e){t.exports='\x3c!--\n    Copyright (c)  Universit\xe9 catholique Louvain.  All rights reserved\n    Authors : Benjamin Daubry & Bruno Marchesini and J\xe9r\xf4me Lemaire & Corentin Lamy\n    Date : 2018-2019\n    This file is part of Stud.UCLouvain\n    Licensed under the GPL 3.0 license. See LICENSE file in the project root for full license information.\n\n    Stud.UCLouvain is free software: you can redistribute it and/or modify\n    it under the terms of the GNU General Public License as published by\n    the Free Software Foundation, either version 3 of the License, or\n    (at your option) any later version.\n\n    Stud.UCLouvain is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU General Public License for more details.\n\n    You should have received a copy of the GNU General Public License\n    along with Stud.UCLouvain.  If not, see <http://www.gnu.org/licenses/>.\n--\x3e\n\x3c!--EN-TETE--\x3e\n<ion-header>\n    <ion-toolbar>\n        <ion-buttons slot="start">\n            <ion-button (click)="alertService.applyFilters(categories, dateRange)">{{\'SPORTS.CANCEL\' | translate}}\n            </ion-button>\n        </ion-buttons>\n        <ion-row>\n            <ion-col>\n                <ion-title>\n                    {{\'SPORTS.FILTER\' | translate}}\n                </ion-title>\n            </ion-col>\n        </ion-row>\n        <ion-buttons slot="end">\n            <ion-button (click)="alertService.applyFilters(categories, dateRange)" strong>{{\'SPORTS.APPLY\' | translate}}\n            </ion-button>\n        </ion-buttons>\n    </ion-toolbar>\n</ion-header>\n\n\x3c!--BODY--\x3e\n<ion-content class="outer-content">\n\n    <ion-toolbar color="uclouvain">\n        <ion-buttons slot="start">\n            <ion-button (click)="uncheckAll()" color="light">\n                <ion-label>{{\'SPORTS.UNTOGGLE\' | translate}}</ion-label>\n                <ion-icon name="done-all" slot="end"></ion-icon>\n            </ion-button>\n        </ion-buttons>\n        <ion-buttons slot="end">\n            <ion-button (click)="resetFilters()" color="light">\n                <ion-label>{{\'SPORTS.RESTORE\' | translate}}</ion-label>\n                <ion-icon name="refresh-circle" slot="end"></ion-icon>\n            </ion-button>\n        </ion-buttons>\n    </ion-toolbar>\n    <ion-list>\n        <ion-list-header>\n            <ion-label>{{\'SPORTS.SPORTS\' | translate}}</ion-label>\n        </ion-list-header>\n\n        <ion-item *ngFor="let category of categories">\n            <ion-label>{{category.name}}</ion-label>\n            <ion-toggle [(ngModel)]="category.isChecked" color="secondary"></ion-toggle>\n        </ion-item>\n\n    </ion-list>\n\n\n</ion-content>'},QZse:function(t,e){t.exports='@charset "UTF-8";\n/*\n    Copyright (c)  Universit\xe9 catholique Louvain.  All rights reserved\n    Authors : Benjamin Daubry & Bruno Marchesini and J\xe9r\xf4me Lemaire & Corentin Lamy\n    Date : 2018-2019\n    This file is part of Stud.UCLouvain\n    Licensed under the GPL 3.0 license. See LICENSE file in the project root for full license information.\n\n    Stud.UCLouvain is free software: you can redistribute it and/or modify\n    it under the terms of the GNU General Public License as published by\n    the Free Software Foundation, either version 3 of the License, or\n    (at your option) any later version.\n\n    Stud.UCLouvain is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU General Public License for more details.\n\n    You should have received a copy of the GNU General Public License\n    along with Stud.UCLouvain.  If not, see <http://www.gnu.org/licenses/>.\n*/\n'},y51y:function(t,e){t.exports='@charset "UTF-8";\n/*\n    Copyright (c)  Universit\xe9 catholique Louvain.  All rights reserved\n    Authors : Benjamin Daubry & Bruno Marchesini and J\xe9r\xf4me Lemaire & Corentin Lamy\n    Date : 2018-2019\n    This file is part of Stud.UCLouvain\n    Licensed under the GPL 3.0 license. See LICENSE file in the project root for full license information.\n\n    Stud.UCLouvain is free software: you can redistribute it and/or modify\n    it under the terms of the GNU General Public License as published by\n    the Free Software Foundation, either version 3 of the License, or\n    (at your option) any later version.\n\n    Stud.UCLouvain is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU General Public License for more details.\n\n    You should have received a copy of the GNU General Public License\n    along with Stud.UCLouvain.  If not, see <http://www.gnu.org/licenses/>.\n*/\n.spinner-container {\n  width: 100%;\n  text-align: center;\n  padding: 10px; }\n.large-icon {\n  font-size: 40px; }\nion-content.all {\n  --ion-background-color: #0f1d41 !important; }\nion-content.all ion-searchbar {\n    --ion-background-color: white; }\nion-content.team {\n  --ion-background-color: #90c53e !important; }\nion-content.team ion-label {\n    color: white !important; }\nion-content.team ion-searchbar {\n    --ion-background-color: white; }\nion-label * {\n  color: var(--ion-color-sport); }\nion-label {\n  color: white !important; }\n'}}]);